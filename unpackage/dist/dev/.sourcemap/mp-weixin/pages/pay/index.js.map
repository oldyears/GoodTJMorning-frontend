{"version":3,"sources":["uni-app:///main.js",null,"webpack:///F:/homework_set/third-dowm/专综/project-rjwm-weixin-uniapp-develop-wsy/GoodTJMorning-frontend/pages/pay/index.vue?5aaf","webpack:///F:/homework_set/third-dowm/专综/project-rjwm-weixin-uniapp-develop-wsy/GoodTJMorning-frontend/pages/pay/index.vue?08e2","webpack:///F:/homework_set/third-dowm/专综/project-rjwm-weixin-uniapp-develop-wsy/GoodTJMorning-frontend/pages/pay/index.vue?b934","uni-app:///pages/pay/index.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","timeout","rocallTime","orderId","orderDataInfo","activeRadio","payMethodList","times","created","mounted","onLoad","methods","handleSave","uni","url","clearTimeout","orderNumber","payMethod","res","package","err","payRes","console","title","icon","setTimeout","duration","runTimeBack","min","sec","that"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACyD;AACjC;;;AAG5E;AAC0M;AAC1M,gBAAgB,kNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACxBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAwxB,CAAgB,wyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;AC0D5yB;AACA;AAAA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;EACA;EACAC,yCACA;IACA;IACAC;MAAA;MACA;QACA;QACAC;UACAC;QACA;MACA;QACA;QACAC;QACA;UACAC;UACAC;QACA;QACA;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBAAA,MACAC;sBAAA;sBAAA;oBAAA;oBAAA;oBAAA,OACAL,mDACAK;sBACAC;oBAAA,GACA;kBAAA;oBAAA;oBAAA;oBAHAC;oBAAAC;oBAIAC;oBAAA,KACAF;sBAAA;sBAAA;oBAAA;oBAAA;oBAAA,OACAP;sBAAAU;sBAAAC;oBAAA;kBAAA;oBACAC;sBACA;sBACAZ;wBACAC;sBACA;oBACA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA,OAEAD;sBAAAU;sBAAAC;oBAAA;kBAAA;oBACAC;sBACA;sBACAZ;wBACAC;sBACA;oBACA;kBAAA;oBAAA;oBAAA;kBAAA;oBAGAD;sBACAU;sBACAG;sBACAF;oBACA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAEA;UAAA;YAAA;UAAA;QAAA;MACA;IACA;IACA;IACAG;MACA;MACA;MACA;MACA;MACA;QACA;QACAZ;MACA;QACA;QACA;QACA;UACAa;QACA;UACAA;QACA;QACA;UACAC;QACA;UACAA;QACA;QACA;QACA;QACA;UACA;YACA;YACAd;YACA;UACA;UACA;YACAe;UACA;QACA;MACA;IACA;EAAA;AAEA;AAAA,2B","file":"pages/pay/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/pay/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=32f2f1fc&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./../common/Navbar/navbar.scss?vue&type=style&index=0&id=32f2f1fc&lang=scss&scoped=true&\"\nimport style1 from \"./../order/style.scss?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"32f2f1fc\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/pay/index.vue\"\nexport default component.exports","export * from \"-!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=32f2f1fc&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.shopInfo()\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\software\\\\HBuilderX.4.08.2024040127\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<!--购买页-->\r\n<template>\r\n  <view class=\"customer-box\">\r\n    <view class=\"wrap\">\r\n      <view class=\"contion\">\r\n        <view class=\"orderPay\">\r\n          <view>\r\n            <view v-if=\"timeout\">订单已超时</view>\r\n            <view v-else\r\n              >支付剩余时间<text>{{ rocallTime }}</text></view\r\n            >\r\n          </view>\r\n          <view class=\"money\"\r\n            >￥<text>{{ orderDataInfo.orderAmount }}</text></view\r\n          >\r\n          <view>{{ shopInfo().shopName }}-{{ orderDataInfo.orderNumber }}</view>\r\n        </view>\r\n      </view>\r\n      <view class=\"box payBox\">\r\n        <view class=\"contion\">\r\n          <view class=\"example-body\">\r\n            <radio-group class=\"uni-list\" @change=\"styleChange\">\r\n              <view class=\"uni-list-item\">\r\n                <view\r\n                  class=\"uni-list-item__container\"\r\n                  v-for=\"(item, index) in payMethodList\"\r\n                  :key=\"item\"\r\n                >\r\n                  <view class=\"uni-list-item__content\">\r\n                    <icon class=\"wechatIcon\"></icon\r\n                    ><text class=\"uni-list-item__content-title\">{{\r\n                      item\r\n                    }}</text>\r\n                  </view>\r\n                  <view class=\"uni-list-item__extra\">\r\n                    <radio\r\n                      :value=\"item\"\r\n                      color=\"#a7f3c9\"\r\n                      :checked=\"index == activeRadio\"\r\n                      class=\"radioIcon\"\r\n                    />\r\n                  </view>\r\n                </view>\r\n              </view>\r\n            </radio-group>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <view class=\"bottomBox btnBox\">\r\n        <button class=\"add_btn\" type=\"primary\" plain=\"true\" @click=\"handleSave\">\r\n          确认支付\r\n        </button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport { paymentOrder, cancelOrder } from \"@/pages/api/api.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      timeout: false,\r\n      rocallTime: \"\",\r\n      orderId: null,\r\n      orderDataInfo: {},\r\n      activeRadio: 0,\r\n      payMethodList: [\"微信支付\"],\r\n      times: null,\r\n    };\r\n  },\r\n  created() {\r\n    this.orderDataInfo = this.orderData();\r\n  },\r\n  mounted() {\r\n    this.runTimeBack();\r\n  },\r\n  onLoad(options) {\r\n    this.orderId = options.orderId;\r\n  },\r\n  methods: {\r\n    ...mapState([\"orderData\", \"shopInfo\"]),\r\n    // 支付详情\r\n    handleSave() {\r\n      if (this.timeout) {\r\n        cancelOrder(this.orderId).then((res) => {});\r\n        uni.redirectTo({\r\n          url: \"/pages/details/index?orderId=\" + this.orderId,\r\n        });\r\n      } else {\r\n        // 如果支付成功进入成功页\r\n        clearTimeout(this.times);\r\n        const params = {\r\n          orderNumber: this.orderDataInfo.orderNumber,\r\n          payMethod: this.activeRadio === 0 ? 1 : 2,\r\n        };\r\n        paymentOrder(params).then(async (res) => {\r\n          if (res.code === 1) {\r\n            const [err, payRes] = await uni.requestPayment({\r\n              ...res.data,\r\n              package: res.data.packageStr, // package 为微信支付必须的字段\r\n            });\r\n            console.log(err, payRes);\r\n            if (err) {\r\n              await uni.showToast({ title: \"支付失败\", icon: \"error\" });\r\n              setTimeout(() => {\r\n                // 下单失败!!\r\n                uni.redirectTo({\r\n                  url: \"/pages/details/index?orderId=\" + this.orderId,\r\n                });\r\n              }, 1500);\r\n            } else {\r\n              await uni.showToast({ title: \"支付成功\", icon: \"success\" });\r\n              setTimeout(() => {\r\n                // 下单成功!!\r\n                uni.redirectTo({\r\n                  url: \"/pages/success/index?orderId=\" + this.orderId,\r\n                });\r\n              }, 1500);\r\n            }\r\n          } else {\r\n            uni.showToast({\r\n              title: res.msg,\r\n              duration: 1000,\r\n              icon: \"none\",\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // // 订单倒计时\r\n    runTimeBack() {\r\n      const end = Date.parse(this.orderDataInfo.orderTime.replace(/-/g, \"/\"));\r\n      const now = Date.parse(new Date());\r\n      const m15 = 15 * 60 * 1000;\r\n      const msec = m15 - (now - end);\r\n      if (msec < 0) {\r\n        this.timeout = true;\r\n        clearTimeout(this.times);\r\n      } else {\r\n        let min = parseInt((msec / 1000 / 60) % 60);\r\n        let sec = parseInt((msec / 1000) % 60);\r\n        if (min < 10) {\r\n          min = \"0\" + min;\r\n        } else {\r\n          min = min;\r\n        }\r\n        if (sec < 10) {\r\n          sec = \"0\" + sec;\r\n        } else {\r\n          sec = sec;\r\n        }\r\n        this.rocallTime = min + \":\" + sec;\r\n        let that = this;\r\n        if (min >= 0 && sec >= 0) {\r\n          if (min === 0 && sec === 0) {\r\n            this.timeout = true;\r\n            clearTimeout(this.times);\r\n            return;\r\n          }\r\n          this.times = setTimeout(function () {\r\n            that.runTimeBack();\r\n          }, 1000);\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style src=\"./../common/Navbar/navbar.scss\" lang=\"scss\" scoped></style>\r\n<style src=\"./../order/style.scss\" lang=\"scss\"></style>\r\n<style>\r\n</style>\r\n"],"sourceRoot":""}